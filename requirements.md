## 一、核心使用场景

* **个人交易决策辅助工具**（中国股票与期货市场）
* 使用 **AL Brooks Price Action** 的方法进行交易分析与决策
* 实时查看行情走势，快速测量盈亏比，判断交易位置的风险与潜在收益
* 便捷使用测量工具（Measure Move 与 Measure）辅助分析交易的合理性

---

## 二、具体功能要求

### （一）行情显示（极简、精准）

* 只需要清晰的 **K线图**
* 指标限定为 **EMA20、MA16**，不包含其他任何指标与成交量信息
* 支持切换 **对数（Log）与百分比（%）** 视图
* 支持多个周期（如5分钟、15分钟、60分钟、日线）

---

### （二）测量工具（最核心需求）

#### 1. Measured Move 工具（盈亏比测量）

* 功能：

  * 手动指定图表上的 **止损点**（0）和 **入场点**（1）
  * 工具自动计算并清晰展示 **1倍盈亏比** 和 **2倍盈亏比** 的止盈目标价位（点2、点3）

* 计算逻辑：

  * 盈亏距离 = 入场价 - 止损价
  * **做多**：

    * 点2 = 入场价 + 盈亏距离
    * 点3 = 入场价 + 盈亏距离 × 2
  * **做空**：

    * 点2 = 入场价 - 盈亏距离
    * 点3 = 入场价 - 盈亏距离 × 2

* 交互方式：

  * 鼠标拖动交互，动态计算实时显示，无需额外点击或输入。

#### 2. Measure 工具（测量行情走势）

* 功能：

  * 在图表上测量任意两点之间的价格变化、波动幅度。
  * 测量完成后停留显示，可快速复制和拖动，用以判断不同走势间是否存在关联性。

---

## 三、数据服务与架构要求（精简可靠）

* 数据源：**openctp Python API**
* 后端API：使用 **FastAPI** 搭建简单明了的接口，实时行情与测量数据计算。
* 实时数据推送使用 **WebSocket**，确保图表动态更新流畅可靠。

---

## 四、前端图表要求（聚焦工具交互）

* 采用 **TradingView Lightweight Charts** 或申请 **Advanced Charts**。
* 开发轻量级、精准的测量工具界面，重交互、易操作。
* 工具仅限你个人使用，不必考虑多用户、多环境部署，专注性能与交互体验。

---

## 五、部署与运行（方便易维护）

* 使用 **Docker** 轻量化部署，便于本地或服务器快速运行与更新。
* 后端选用 **SQLite** 数据库，极简管理数据（历史行情缓存）。
* 缓存方案（如有需要）：简单使用内存缓存或可选Redis。

---

## 六、非功能需求（确保稳定易用）

* 实时数据推送快速流畅，响应延迟 < 500ms
* 服务器资源占用低、稳定运行、不频繁维护
* 设计简单直观，避免误操作或信息冗余干扰决策效率

---

## 七、下一步明确的行动计划（快速启动开发）

* 完成基本的图表渲染环境配置（确认数据源、TradingView接口授权）
* 快速原型开发Measured Move工具的计算逻辑和前端交互
* 测试测量工具的实际使用体验，进行微调优化后再逐步扩展功能
